<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>SSGPE</title>
  <script type="text/JavaScript" src="../Recursos/js/Funciones.js"></script>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.6 -->
  <link rel="stylesheet" href="../Recursos/admin/bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../Recursos/admin/dist/css/AdminLTE.min.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="../Recursos/admin/dist/css/skins/_all-skins.min.css">

  <link rel="stylesheet" href="../Recursos/openlayers/ol.css" type="text/css">
    <script src="../Recursos/openlayers/ol.js"></script>
    <script src="../Recursos/js/jquery-1.12.1.min.js"></script>
  <script src="../Recursos/bootstrap/dist/js/bootstrap.min.js"></script>

  

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  <style>
        #map-id 
        {
                width: auto;
                height: 300px;
        }
    </style>
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <header class="main-header">
    <!-- Logo -->
    <a href="index.html" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
      <span class="logo-mini"><b>SSGPE</b></span>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg"><b>SSGPE</b>/Admin</span>
    </a>
    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>

      <div class="navbar-custom-menu">
        <ul class="nav navbar-nav">
          
          
          
          <!-- User Account: style can be found in dropdown.less -->
          <li class="dropdown user user-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              
              <span class="username" onclick="Cerrar_Sesion()">Cerrar Sesion</span>
            </a>
            
          </li>
          
        </ul>
      </div>
    </nav>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
      <!-- Sidebar user panel -->
      
      
      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu">
        <li class="header">Herramientas</li>
        
        
       
        <li class="treeview">
          <a href="#">
            <i class="fa fa-edit"></i> <span>Usuarios</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li><a href="../Admin/usuarios.html"><i class="fa fa-circle-o"></i>Administrar Usuarios</a></li>
            <li><a href="../Admin/crear_usuario.html"><i class="fa fa-circle-o"></i>Crear Usuario</a></li>
           </ul>
        </li>
        
      </ul>
    </section>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        
        <small> </small>
      </h1>
      <ol class="breadcrumb">
        <li>Administrador</li>
        <li class="active">Herramientas</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">
     
         <!-- USERS LIST -->
              <div class="box box-info" >
                  <div class="box-header with-border" style="text-align: center;">
                        <h3 class="box-title">Sistema de Servicios Geograficos para Procesos Electorales</h3>
                        <br>
                        <div class="icon" style="align: center;">
                            <a href="mapa.html" class="logo"><i class="fa fa-pie-chart"></i></a>
                            <label>Historial</label>
                            <a href="pronostico.html" class="logo"><i class="fa fa-line-chart"></i></a> 
                            <label>Pronostico</label> 
                            <br>
                            <a href="registros.html" class="logo"><i class="fa fa-file-text-o"></i></a>
                            <label>Registros</label>
                         </div> 
                        <br> <label for="sel1">A침o de Elecci칩n</label>
                        <select id="idSelectAnio" class="form-control" name="a침o" onchange="renderizarTabla();">


                          <option selected="selected">2015</option>
                          <option>2012</option>
                          <option>2009</option>
                          <option>2006</option>
                          <option>2003</option>
                          <option>2000</option>
                        </select>
                      
                </div>
                  
                    <div class="col-md-3" hidden>
                        <label for="sel1">Parametros</label>

                        <select class="form-control" id="param" name="param">
                            <option name="partido" id="partido" value="partido">Partidos Politicos</option>
                            <option name="participacion" id="participacion" value="participacion">Participaci칩n Ciudadana</option>
                <!--            <option name="pronostico" id="pronostico" value="pronostico">Pronostico</option>-->
                        </select>
                    </div>
                  
                  
                  <div class="box-body no-padding">
                    
                        <!--                   ********************************-->
                        <div class="row">
                            <div class="col-md-12 table-responsive" id="idVistaGeneral" ></div>
                </div>
                        <!--******************************************-->
                    
                   </div>
                  
              </div>
                <!-- /.box-header -->
                
                <!-- /.box-body -->
        </section>  
    
              </div>
              <!--/.box -->
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
 <script type="text/javascript">

var root;

var tabla = $('<table id="idTablaVistaGeneral" class="table table-striped table-hover table-bordered" ></table>');
$('#idVistaGeneral').append(tabla);

var nombre;
var tabla1;
var crearEncabezado = true;
var arrPartidosPorTabla = [];

var thead = $('<thead></thead>');
var theadtr = $('<tr class="info"></tr>');
var nombreD = $('<th>Delegaci&oacute;n</th>');
theadtr.append(nombreD);

var tbody = $('<tbody class="text-center"></tbody>');

function generarTablas(result)
{
	root = result.firstChild;

	nombre = root.children[1].textContent;
	tabla1 = root.children[3];

	agregarEncabezados(tabla1.children);
}

function agregarEncabezados(partidos)
{
	for(var i = 0; i < partidos.length ; i++ )
	{
		if($.inArray(partidos[i].children[0].textContent, arrPartidosPorTabla) == -1 )
		{
			var th = $('<th class="text-center">' + partidos[i].children[0].textContent + '</th>');

			theadtr.append(th);
			arrPartidosPorTabla.push(partidos[i].children[0].textContent);
		}

		//console.log(partidos[i].children[0].textContent);
		
	}

	thead.append(theadtr);
	tabla.append(thead);

	agregarFila(partidos); /// <-------- revisar
}

function agregarFila(partidos)
{
	var tr = $('<tr></tr>');

	var delegacion = $('<th>' + nombre + '</th>');
	tr.append(delegacion);
	

	for(var i = 0; i < partidos.length ; i++ )
	{
		for(var j = 0; j < partidos.length ; j++ )
		{
			if($.inArray(partidos[j].children[0].textContent, arrPartidosPorTabla) == i )
			{
				var td = $('<td>' + partidos[j].children[1].textContent + '</td>');
				tr.append(td);
			}
		}
	}

	tbody.append(tr);
}




function getURLIco(partido)
{
	var URL = 'http://localhost:8080/TT/Recursos/img/';

	if(partido == 'morena')
		return URL + 'morena_ico.png';

	if(partido == 'prd_pt')
		return URL + 'prd_pt_ico.png';

	if(partido == 'pan')
		return URL + 'pan_ico.png';

	if(partido == 'pri_pvem')
		return URL + 'pri_pvem_ico.png';

	if(partido == 'pes')
		return URL + 'pes_ico.png';

	if(partido == 'panal' || partido == 'na')
		return URL + 'panal_ico.png';

	if(partido == 'ph')
		return URL + 'ph_ico.png';

	if(partido == 'mc')
		return URL + 'mc_ico.png';

	if(partido == 'prd_pt_panal')
		return URL + 'prd_pt_panal.png';

	if(partido == 'prd')
		return URL + 'prd_ico.png';

	if(partido == 'pt')
		return URL + 'pt_ico.png';

	if(partido == 'indep')
		return URL + 'indep_ico.png';

	if(partido == 'pri')
		return URL + 'pri_ico.png';

	if(partido == 'prd_pt_mc')
		return URL + 'PRD-PT-MC.jpg';

	if(partido == 'pvem')
		return URL + 'pvem_ico.png';

	if(partido == 'con')
		return URL + 'con_ico.png';

	if(partido == 'prd_pt_con')
		return URL + 'PorElBienDeTodos.jpg';

	if(partido == 'prd_con')
		return URL + 'prd_con.jpg';

	if(partido == 'psd' || partido == 'pasc')
		return URL + 'psd_ico.png';

	if(partido == 'pt_con')
		return URL + 'pt_con_ico.png';

	if(partido == 'pan_na')
		return URL + 'pan_na.jpg';


	


}


/////////////////////////////////////////////////////////
function primerRenderizado()
{
    


for(var i = 2 ; i <= 16 ; i++ )
{
	var clave;
	if(i < 10)
		clave = '00' + i;
	if(i >= 10)
		clave = '0' + i;

	$.ajax
	({ 
		type: "GET",  
		async: false,
		url: "http://localhost:8080/TT/SComparativa",  
		data: "cve=" + clave + "&anio=" +$('#idSelectAnio').val()+"&sesion="+sessionStorage.getItem("SClave"),  
		success: generarTablas
		,
		error: function (xhr, ajaxOptions, thrownError)
		{
		    console.log("Error: "+xhr.status);
		    console.log("Error: "+ thrownError);
		}
	});
}

tabla.append(tbody);



$('#idVistaGeneral table thead tr th').each
(
	function(index)
	{
		if(index != 0)
		{
			console.log($(this).get(0).textContent);
			var urlICO = getURLIco($(this).get(0).textContent);
			$(this).empty();
			$(this).append('<img src=' + urlICO + ' height="42px" width="auto" ></img>');
		}
	}
);

$('#idVistaGeneral table tbody tr').each
(
	function()
	{
		//console.log($(this).get(0).children);

		var $menor = $(this).get(0).children[1];
		var $mayor = $(this).get(0).children[2];

		if(parseInt($menor.textContent) > parseInt($mayor.textContent))
			$mayor = $menor;

		for(var i = 3 ; i < $(this).get(0).children.length ; i++ )
		{
			$menor = $(this).get(0).children[i];

			if(parseInt($menor.textContent) > parseInt($mayor.textContent))
				$mayor = $menor;
		}

		//console.log($mayor);
		$mayor.bgColor ='#E6EFDA';
	}
);

}
function renderizarTabla()
{
    tabla.empty();
    arrPartidosPorTabla = [];

	thead = $('<thead></thead>');
	theadtr = $('<tr class="info"></tr>');
	nombreD = $('<th>Delegaci&oacute;n</th>');
	theadtr.append(nombreD);
	tbody = $('<tbody class="text-center"></tbody>');
    primerRenderizado();
}

primerRenderizado();
</script>
  <style>
      .icon{
    -webkit-transition: all .3s linear;
    -o-transition: all .3s linear;
    transition: all .3s linear;
    
    top: -10px;
    right: 10px;
    z-index: 0;
    font-size: 90px;
    color: rgba(0,0,0,0.15);
      }
      
      .box {
    position: relative;
    border-radius: 3px;
    background: #ffffff;
    border-top: 3px solid #d2d6de;
    margin-bottom: 20px;
    width: 100%;
    box-shadow: 0 1px 1px rgba(0,0,0,0.1);
}
        .box-header {
            color: #444;
            display: block;
            padding: 10px;
            position: relative;
        }
        #center {
        text-align: center;
        position: absolute;
        top:0;
        left:0;
        right:0;
        bottom:0;
        margin: auto;
        background: #DBDBDB;
        height: 100px;
        width: 300px;
        box-shadow: 0 0 4px rgba(0,0,0,.3);
        }
  </style>

  





  
    <!-- AdminLTE App -->
<script src="../Recursos/admin/dist/js/app.min.js"></script>

<!-- AdminLTE for demo purposes -->
<script src="../Recursos/admin/dist/js/demo.js"></script>

</body>
</html>
